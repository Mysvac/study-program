# PL0语言编译器

编译原理课程项目

尝试使用试验性 C++23 标准模块。

## 项目自身的编译要求说明

1. 本项目默认在window下编译，linux未经过测试。
2. 标准库模块需要C++23，现在依然是测试性（2025/4/7）。
3. 使用CMake进行项目配置，使用CMake预设简化指令。
4. 使用Ninja作为生成器（只有ninja支持模块）。
5. 使用MSVC作为编译器，必须是Visual Studio 2022 previw 的较新版本。
6. linux下无法使用msvc，可尝试使用最新版本的Clang。（GCC尚不支持标准库模块。）
7. vscode智能感知对模块支持不加，需要借助`.vscode/settings.json`中的`C_Cpp.default.compileCommands`参数才行

## 完整的编译器程序

代码文件：`src/main.cpp` 和 `modules/PLZero.ixx`

预编译好的程序在 `./build/bin/plzc.exe`<br>
此文件夹内还提供了几个测试源文件。

注：plzc = PL Zero Compiler

编译器使用方式：
```shell
plzc.exe -i 输入文件路径 -o 输出文件路径 -c

# '-c' 表示为输出文件添加注释，可以省略
# '-o 输出文件路径' 可以省略，默认输出到当前路径的 output.txt
# '-i' 参数可以省略，但是必须有输入文件名
# 最简命令如下：
plzc.exe 输入文件路径
```

目标程序命令说明（假想的栈式汇编命令）：
- lit 0 a : 将常量（字面量）a存入栈顶
- lod L a : 将变量L-a的值存入栈顶，L是相对深度差，a是偏移量
- sto L a : 将栈顶存入 L-a， 同上
- cal 0 a : 调用第a行的代码，a必须是函数（过程）的开头
- int 0 a : 栈增加a个空间，a应该是 函数局部变量个数 + 3
- jmp 0 a : 无条件跳转到a行代码
- jpc 0 a : 根据栈顶，条件跳转到a或者继续执行（条件为假时跳转？）
- opr 0 a
    - a=0 : 结束过程调用，清除栈。在函数末尾使用。
    - a=1 : 栈顶取反
    - a=2~5 : 分别是 加 减 乘 除， 使用栈顶2个元素进行操作
    - a=6 : odd命令，对栈顶奇偶判断
    - a=8~13 : 比较运算，分别对应 = != < > <= >=


## 仅词法分析器的测试程序
由于实验要求，需要为词法分析法设定单独分析程序。

代码文件：`lexer-src/main.cpp` 和 `modules/PLZero.ixx`

预编译好的程序在 `./build/bin/lexer.exe`<br>
此文件夹内还提供了几个测试源文件。

编译器使用方式（词法分析用于测试，只有输入文件，输出直接显示在控制台）：
```shell
plzc.exe 输入文件路径
```
